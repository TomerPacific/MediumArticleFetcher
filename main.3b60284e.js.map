{"version":3,"sources":["userProfile.ts","constants.ts","main.ts"],"names":[],"mappings":"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","file":"main.3b60284e.js","sourceRoot":"..\\src","sourcesContent":["export class UserProfile {\r\n    profileLink: string;\r\n    profileImg: string;\r\n\r\n\r\n    constructor(link: string, image: string) {\r\n        this.profileLink = link;\r\n        this.profileImg = image;\r\n    }\r\n}","export const GET_REQUEST: string = \"GET\";\r\nexport const READY_STATE_OK: Number = 4;\r\nexport const RESPONSE_STATUS_OK: Number = 200;\r\nexport const ENTER_KEY: string = \"Enter\";\r\nexport const ENDPOINT: string = \"https://medium-fetcher.herokuapp.com/medium/\";","\r\nimport { Article } from \"./article\";\r\nimport { ServerResponse } from \"./serverResponse\";\r\nimport { UserProfile } from \"./userProfile\";\r\nimport { GET_REQUEST, READY_STATE_OK, RESPONSE_STATUS_OK, ENTER_KEY, ENDPOINT } from \"./constants\";\r\n\r\nlet userProfileDiv: HTMLElement = document.getElementById('userProfile');\r\nlet articlesList:HTMLElement = document.getElementById('articles');\r\nlet spinner: HTMLElement = document.getElementById('spinner');\r\nlet username: HTMLElement = document.getElementById('username');\r\nlet errorHeader: HTMLElement = document.getElementById('errorMessage');\r\nlet searchBtn: HTMLElement = document.getElementById('search');\r\n\r\nusername.addEventListener(\"keyup\", function(event: KeyboardEvent) {\r\n    if (event.key === ENTER_KEY) {\r\n        event.preventDefault();\r\n        fetchMediumRSSFeed();\r\n    }\r\n});\r\n\r\nsearchBtn.addEventListener(\"click\", function(event: MouseEvent) {\r\n    fetchMediumRSSFeed();\r\n});\r\n\r\nfunction fetchArticles() {\r\n    let request: XMLHttpRequest = new XMLHttpRequest();\r\n    let url = ENDPOINT + (<HTMLInputElement>username).value;\r\n    request.open(GET_REQUEST, url);\r\n    request.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    try {\r\n        request.send(null);\r\n    } catch(exception) {\r\n        console.error(exception);\r\n    }\r\n\r\n    return new Promise(function(resolve, reject) {\r\n        request.onreadystatechange = function() {\r\n            if (this.readyState === READY_STATE_OK && this.status === RESPONSE_STATUS_OK) {\r\n                let text = JSON.parse(this.responseText);\r\n                resolve(text);\r\n            } else if (this.status !== RESPONSE_STATUS_OK) {\r\n                let errorMsg = this.statusText ? this.statusText : \"Error in response\";\r\n                reject(errorMsg);\r\n            }\r\n        }\r\n    });\r\n    \r\n}\r\n\r\nfunction fetchMediumRSSFeed() {\r\n    if ((<HTMLInputElement>username).value.length === 0) {\r\n        return;\r\n    }\r\n\r\n    let articles: Article[] = [];\r\n\r\n    resetContent();\r\n    fetchArticles()\r\n    .then(function(response: ServerResponse) {\r\n        let userData: UserProfile = new UserProfile(response.message.link, response.message.image);\r\n        articles = getArticlesFromResponse(response.message.items);\r\n        populateUserData(userData);\r\n        populateArticles(articles);\r\n        spinner.style.display = 'none';\r\n    })\r\n    .catch(function(errorMessage) {\r\n        spinner.style.display = 'none';\r\n        errorHeader.innerHTML = errorMessage.message ? errorMessage.message : \"An error has occurred.\";\r\n        errorHeader.style.display = 'inline-block';\r\n    });\r\n}\r\n\r\nfunction resetContent() {\r\n    errorHeader.style.display = 'none';\r\n    spinner.style.display = 'inline-block';\r\n    userProfileDiv.innerHTML = '';\r\n    articlesList.innerHTML = '';\r\n}\r\n\r\nfunction getArticlesFromResponse(mediumArticles: Article[]) : Article[] {\r\n    \r\n    //If an item does not have a category attribute it is not an article\r\n    let filteredArticles = mediumArticles.filter(function(article: Article) {\r\n        return article.hasOwnProperty('category');\r\n    });\r\n\r\n    return filteredArticles;\r\n}\r\n\r\nfunction populateUserData(userData: UserProfile) {\r\n    let anchorElement = document.createElement('a');\r\n    let userAvatar = document.createElement('img'); \r\n    let userName = document.createElement('h2');\r\n\r\n    userName.innerHTML = (<HTMLInputElement>username).value;\r\n    userName.setAttribute('id', 'username');\r\n\r\n    userAvatar.setAttribute('src', userData.profileImg);\r\n    userAvatar.setAttribute('id', 'userAvatar');\r\n    userAvatar.style.width = '200px';\r\n    userAvatar.style.height = '200px';\r\n\r\n    anchorElement.href = userData.profileLink;\r\n    anchorElement.setAttribute('target', '_blank');\r\n    anchorElement.appendChild(userAvatar);\r\n\r\n    userProfileDiv.appendChild(userName);\r\n    userProfileDiv.appendChild(anchorElement);\r\n}\r\n\r\nfunction populateArticles(articles: Article[]) {\r\n    for(let index = 0; index < articles.length; index++) {\r\n\r\n        let liElem = document.createElement('li');\r\n        let anchorElem = document.createElement('a');\r\n\r\n        let article = articles[index];\r\n        \r\n        anchorElem.href = article.link;\r\n        anchorElem.title = article.title;\r\n        anchorElem.setAttribute('target', '_blank');\r\n        anchorElem.innerHTML = article.title;\r\n\r\n        liElem.appendChild(anchorElem);\r\n        articlesList.appendChild(liElem);\r\n    }\r\n}\r\n"]}