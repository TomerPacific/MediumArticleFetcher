{"version":3,"sources":["main.ts"],"names":[],"mappings":";AAwJC,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IApJD,IAAM,EAAsB,MACtB,EAAyB,EACzB,EAA6B,IAC7B,EAAyB,GACzB,EAAmB,+CAErB,EAA0B,KAC1B,EAAsB,GAEtB,EAA8B,SAAS,eAAe,eACtD,EAA2B,SAAS,eAAe,YACnD,EAAuB,SAAS,eAAe,WAC/C,EAAwB,SAAS,eAAe,YAChD,EAA2B,SAAS,eAAe,gBASvD,SAAA,IACI,EAAU,IAAI,eACV,IAAA,EAAM,EAA8B,EAAU,MAClD,EAAQ,KAAK,EAAa,GAC1B,EAAQ,iBAAiB,eAAgB,oBACrC,IACA,EAAQ,KAAK,MACf,MAAM,GACJ,QAAQ,MAAM,GAGX,OAAA,IAAI,QAAQ,SAAS,EAAS,GACjC,EAAQ,mBAAqB,WACrB,GAAA,KAAK,aAAe,GAAkB,KAAK,SAAW,EAAoB,CACtE,IAAA,EAAO,KAAK,MAAM,KAAK,cAC3B,EAAQ,QACL,GAAI,KAAK,SAAW,EAAoB,CACvC,IAAA,EAAW,KAAK,WAAa,KAAK,WAAa,oBACnD,EAAO,OAOvB,SAAA,IAEsD,IAA3B,EAAU,MAAM,SAIvC,IACA,IACC,KAAK,SAAS,GACP,IAAA,EAAW,EAAwB,GACvC,EAAwB,EAAS,QAAQ,OACzC,EAAiB,GACjB,IACA,EAAQ,MAAM,QAAU,SAE3B,MAAM,SAAS,GACZ,EAAQ,MAAM,QAAU,OACxB,EAAY,UAAY,EAAa,QAAU,EAAa,QAAU,yBACtE,EAAY,MAAM,QAAU,kBAIpC,SAAA,IACI,EAAY,MAAM,QAAU,OAC5B,EAAQ,MAAM,QAAU,eACxB,EAAe,UAAY,GAC3B,EAAa,UAAY,GACzB,EAAW,GAGf,SAAA,EAAiC,GACtB,MAAA,CACH,YAAc,EAAS,QAAQ,KAC/B,WAAa,EAAS,QAAQ,OAItC,SAAA,EAAiC,GAEzB,IAAA,IAAI,EAAQ,EAAG,EAAQ,EAAe,OAAQ,IAAS,CACnD,IAAA,EAAgB,EAAe,GAG9B,EAAc,eAAe,aAIlC,EAAS,KAAK,IAItB,SAAA,EAAkC,GAEvB,OADW,IAAI,KAAiC,IAA5B,OAAO,IACtB,UAAU,WAG1B,SAAA,EAAyB,GACjB,IAAA,EAAW,EAAK,QAAQ,OACxB,EAAa,EAAK,QAAQ,SAEvB,OADW,EAAK,UAAU,EAAW,EAAG,EAAa,GAKhE,SAAA,EAA0B,GAClB,IAAA,EAAgB,SAAS,cAAc,KACvC,EAAa,SAAS,cAAc,OACpC,EAAW,SAAS,cAAc,MAEtC,EAAS,UAA+B,EAAU,MAClD,EAAS,aAAa,KAAM,YAE5B,EAAW,aAAa,MAAO,EAAS,YACxC,EAAW,aAAa,KAAM,cAC9B,EAAW,MAAM,MAAQ,QACzB,EAAW,MAAM,OAAS,QAE1B,EAAc,KAAO,EAAS,YAC9B,EAAc,aAAa,SAAU,UACrC,EAAc,YAAY,GAE1B,EAAe,YAAY,GAC3B,EAAe,YAAY,GAG/B,SAAA,IACQ,IAAA,IAAI,EAAQ,EAAG,EAAQ,EAAS,OAAQ,IAAS,CAE7C,IAAA,EAAS,SAAS,cAAc,MAChC,EAAa,SAAS,cAAc,KAEpC,EAAU,EAAS,GAEvB,EAAW,KAAO,EAAQ,KAC1B,EAAW,MAAQ,EAAQ,MAC3B,EAAW,aAAa,SAAU,UAClC,EAAW,UAAY,EAAQ,MAE/B,EAAO,YAAY,GACnB,EAAa,YAAY,IAnIjC,EAAS,iBAAiB,QAAS,SAAS,GACpC,EAAM,UAAY,IAClB,EAAM,iBACN","file":"main.9125b7f6.js","sourceRoot":"..\\src","sourcesContent":["\r\nimport { Article } from \"./article\";\r\nimport { ServerResponse } from \"./serverResponse\";\r\n\r\nconst GET_REQUEST: string = \"GET\";\r\nconst READY_STATE_OK: Number = 4;\r\nconst RESPONSE_STATUS_OK: Number = 200;\r\nconst ENTER_KEY_CODE: Number = 13;\r\nconst ENDPOINT: string = \"https://medium-fetcher.herokuapp.com/medium/\";\r\n\r\nlet request: XMLHttpRequest = null;\r\nlet articles: Article[] = [];\r\n\r\nlet userProfileDiv: HTMLElement = document.getElementById('userProfile');\r\nlet articlesList:HTMLElement = document.getElementById('articles');\r\nlet spinner: HTMLElement = document.getElementById('spinner');\r\nlet username: HTMLElement = document.getElementById('username');\r\nlet errorHeader: HTMLElement = document.getElementById('errorMessage');\r\n\r\nusername.addEventListener(\"keyup\", function(event) {\r\n    if (event.keyCode === ENTER_KEY_CODE) {\r\n        event.preventDefault();\r\n        fetchMediumRSSFeed();\r\n    }\r\n});\r\n\r\nfunction fetchArticles() {\r\n    request = new XMLHttpRequest();\r\n    let url = ENDPOINT + (<HTMLInputElement>username).value;\r\n    request.open(GET_REQUEST, url);\r\n    request.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    try {\r\n        request.send(null);\r\n    } catch(exception) {\r\n        console.error(exception);\r\n    }\r\n\r\n    return new Promise(function(resolve, reject) {\r\n        request.onreadystatechange = function() {\r\n            if (this.readyState === READY_STATE_OK && this.status === RESPONSE_STATUS_OK) {\r\n                let text = JSON.parse(this.responseText);\r\n                resolve(text);\r\n            } else if (this.status !== RESPONSE_STATUS_OK) {\r\n                let errorMsg = this.statusText ? this.statusText : \"Error in response\";\r\n                reject(errorMsg);\r\n            }\r\n        }\r\n    });\r\n    \r\n}\r\n\r\nfunction fetchMediumRSSFeed() {\r\n\r\n    if ((<HTMLInputElement>username).value.length === 0) {\r\n        return;\r\n    }\r\n\r\n    resetContent();\r\n    fetchArticles()\r\n    .then(function(response: ServerResponse) {\r\n        let userData = getUserDataFromResponse(response);\r\n        getArticlesFromResponse(response.message.items);\r\n        populateUserData(userData);\r\n        populateArticles();\r\n        spinner.style.display = 'none';\r\n    })\r\n    .catch(function(errorMessage) {\r\n        spinner.style.display = 'none';\r\n        errorHeader.innerHTML = errorMessage.message ? errorMessage.message : \"An error has occurred.\";\r\n        errorHeader.style.display = 'inline-block';\r\n    });\r\n}\r\n\r\nfunction resetContent() {\r\n    errorHeader.style.display = 'none';\r\n    spinner.style.display = 'inline-block';\r\n    userProfileDiv.innerHTML = '';\r\n    articlesList.innerHTML = '';\r\n    articles = [];\r\n}\r\n\r\nfunction getUserDataFromResponse(response: ServerResponse) {\r\n    return {\r\n        profileLink : response.message.link,\r\n        profileImg : response.message.image\r\n    };\r\n}\r\n\r\nfunction getArticlesFromResponse(mediumArticles: Article[]) {\r\n    \r\n    for(let index = 0; index < mediumArticles.length; index++) {\r\n        let mediumArticle = mediumArticles[index];\r\n\r\n        //If an item does not have a category attribute it is not an article\r\n        if (!mediumArticle.hasOwnProperty('category')) {\r\n            continue;\r\n        }\r\n\r\n        articles.push(mediumArticle);\r\n    }\r\n}\r\n\r\nfunction convertPublishTimeToDate(publishTimeInUnix: string): string {\r\n    let date : Date = new Date(Number(publishTimeInUnix) * 1000);\r\n    return date.getTime().toString();\r\n}\r\n\r\nfunction extractImageUrl(text) {\r\n    let srcIndex = text.indexOf(\"src\");\r\n    let widthIndex = text.indexOf(\"width\");\r\n    let imageSoruce = text.substring(srcIndex + 5, widthIndex - 2);\r\n    return imageSoruce;\r\n}\r\n\r\n\r\nfunction populateUserData(userData) {\r\n    let anchorElement = document.createElement('a');\r\n    let userAvatar = document.createElement('img'); \r\n    let userName = document.createElement('h2');\r\n\r\n    userName.innerHTML = (<HTMLInputElement>username).value;\r\n    userName.setAttribute('id', 'username');\r\n\r\n    userAvatar.setAttribute('src', userData.profileImg);\r\n    userAvatar.setAttribute('id', 'userAvatar');\r\n    userAvatar.style.width = '200px';\r\n    userAvatar.style.height = '200px';\r\n\r\n    anchorElement.href = userData.profileLink;\r\n    anchorElement.setAttribute('target', '_blank');\r\n    anchorElement.appendChild(userAvatar);\r\n\r\n    userProfileDiv.appendChild(userName);\r\n    userProfileDiv.appendChild(anchorElement);\r\n}\r\n\r\nfunction populateArticles() {\r\n    for(let index = 0; index < articles.length; index++) {\r\n\r\n        let liElem = document.createElement('li');\r\n        let anchorElem = document.createElement('a');\r\n\r\n        let article = articles[index];\r\n        \r\n        anchorElem.href = article.link;\r\n        anchorElem.title = article.title;\r\n        anchorElem.setAttribute('target', '_blank');\r\n        anchorElem.innerHTML = article.title;\r\n\r\n        liElem.appendChild(anchorElem);\r\n        articlesList.appendChild(liElem);\r\n    }\r\n}\r\n"]}